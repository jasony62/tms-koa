支持用 npm 包作为插件，实现控制器的扩展。

# 编写控制器插件

编写插件时以`peerDependencies`方式安装`tms-koa`包。

```ts
const { Ctrl, ResultData } = require('tms-koa')

/** 字段一个控制器插件类 */
class YourPlugin extends Ctrl {
  test() {
    return new ResultData('你好')
  }
}
export default YourPlaugin
```

参考：https://github.com/jasony62/tms-koa-ffmpeg

# 配置文件

在配置文件`config/app.js`中`router.controllers.plugins_npm`定义可用的插件包。

`plugins_npm`是一个数组，包括描述插件包的对象。

插件包对象属性：

| 属性名 | 用途                 | 必填 |
| ------ | -------------------- | ---- |
| id     | 控制器类模块名称。   | 是   |
| alias  | 路由中包名称的别名。 | 否   |

`id`作为`require()`方法的参数，获取控制器类。1 条控制器插件配置对应 1 个控制器模块。

控制器类可以全量导出或默认导出。

# 路由匹配规则

路由：`/控制器前缀/插件包名/控制器/方法名`。

其中`控制器`部分可以为空（对应`main.js`），`方法名`必须有。

`tms-koa`检查路由是否和插件包别名匹配，如果匹配用`require(插件包别名/控制器)`查找控制器类。

匹配插件包控制器优先于`controllers`目录下的控制器。

# 安装插件

如果插件包不单独发布，可以将插件包直接复制到项目的`node_modules`目录中。

# 快速运行

通过环境变量`TMS_KOA_CONTROLLERS_DIR`将插件包目录指定`tms-koa`的控制器目录。
